00000000                                     1  ************** AREA DATI ******************************************
00008000                                     2  	ORG	$8000
00008000                                     3  RIS		DS.W		1
00008002  0001                               4  INDX		DC.W		1	;Conta le word gia inviate. Parte da 1 perchè la prima viene inviata nel main
00008004                                     5  
00008004  =00002007                          6  PIACB		EQU		$2007
00008004  =00002006                          7  PIADB		EQU 		$2006
00008004                                     8  *********************************************************************
00008004                                     9  *	 Algoritmo da trasmettere al sistema B 
00008004                                    10  *********************************************************************
00008100                                    11  	ORG	$8100
00008100  2F00                              12  SUM	MOVE.L	D0,-(A7)
00008102  2F01                              13  	MOVE.L	D1,-(A7)
00008104  2F08                              14  	MOVE.L	A0,-(A7)
00008106                                    15  
00008106  207C 00008000                     16  	MOVE.L	#RIS,A0
0000810C  303C 0001                         17  	MOVE.W	#1,D0
00008110  323C 0002                         18  	MOVE.W	#2,D1
00008114  D240                              19  	ADD.W		D0,D1
00008116  3081                              20  	MOVE.W	D1,(A0)
00008118                                    21  
00008118  205F                              22  	MOVE.L	(A7)+,A0
0000811A  221F                              23  	MOVE.L	(A7)+,D1
0000811C  201F                              24  	MOVE.L	(A7)+,D0
0000811E                                    25  	
0000811E  4E75                              26  	RTS	
00008120                                    27  *************************************************************************	
00008200                                    28  	ORG	$8200
00008200  4EB9 00008224                     29  MAIN		JSR	DVBOUT
00008206                                    30  
00008206  40C0                              31  		MOVE.W	SR,D0
00008208  0240 D8FF                         32  		ANDI.W	#$D8FF,D0	;<- passo a stato utente e abilito interruzioni
0000820C  46C0                              33  		MOVE.W	D0,SR
0000820E                                    34  
0000820E  227C 00002006                     35  		MOVEA.L	#PIADB,A1
00008214  207C 00008100                     36  		MOVE.L	#$8100,A0
0000821A                                    37  
0000821A  1011                              38  		MOVE.B	(A1),D0		;Lettura fittizia
0000821C  1290                              39  		MOVE.B	(A0),(A1)	;Scrivo su registro dato della PIA B l'istruzione da inviare
0000821E                                    40  
0000821E                                    41  *************************************************************************
0000821E  4EF9 0000821E                     42  LOOP	JMP	LOOP
00008224                                    43  **************************************************************************
00008224  11FC 0000 2007                    44  DVBOUT	MOVE.B	#0,PIACB
0000822A  11FC 00FF 2006                    45  		MOVE.B	#$FF,PIADB
00008230  11FC 0025 2007                    46  		MOVE.B	#%00100101,PIACB
00008236  4E75                              47  		RTS
00008238                                    48  *******************************************************************************************************
00008238                                    49  * 	Interruzione che controlla se è stato inviato op code di RTS (4E75). Se no invia prossima word
00008238                                    50  *******************************************************************************************************
00008600                                    51  	ORG	$8600
00008600  2F08                              52  INT1	MOVE.L	A0,-(A7)
00008602  2F09                              53  	MOVE.L	A1,-(A7)
00008604  2F0A                              54  	MOVE.L	A2,-(A7)
00008606  2F00                              55  	MOVE.L	D0,-(A7)
00008608  2F01                              56  	MOVE.L	D1,-(A7)
0000860A                                    57  
0000860A  207C 00008100                     58  	MOVE.L	#$8100,A0
00008610  227C 00002006                     59  	MOVEA.L	#PIADB,A1
00008616  247C 00008002                     60  	MOVEA.L	#INDX,A2
0000861C                                    61  
0000861C  1011                              62  	MOVE.B	(A1),D0		;Lettura fittizia	ma utile al confronto
0000861E                                    63  
0000861E  B03C 0075                         64  	CMP.B		#$75,D0
00008622  6700 000C                         65  	BEQ	EOM
00008626  3212                              66  	MOVE.W	(A2),D1
00008628  12B0 1000                         67  	MOVE.B	(A0,D1),(A1)	;Scrivo su dato PIA B la prossima istruzione
0000862C                                    68  
0000862C                                    69  
0000862C  5241                              70  	ADD.W		#1,D1
0000862E  3481                              71  	MOVE.W	D1,(A2)
00008630                                    72  
00008630  221F                              73  EOM	MOVE.L	(A7)+,D1
00008632  201F                              74  	MOVE.L	(A7)+,D0
00008634  245F                              75  	MOVE.L	(A7)+,A2
00008636  225F                              76  	MOVE.L	(A7)+,A1
00008638  205F                              77  	MOVE.L	(A7)+,A0
0000863A                                    78  	
0000863A  4E73                              79  	RTE
0000863C                                    80  
0000863C                                    81  **************************************************************************
0000863C                                    82  	END	MAIN

No errors detected
No warnings generated
